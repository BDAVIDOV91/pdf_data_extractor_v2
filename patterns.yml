patent_and_trademark_institute:
  document_type: patent_invoice
  keywords:
    - "Patent and Trademark Institute"
  invoice_number: '(\d+)\s*Invoice No:|Invoice No:\s*(\d+)'
  date: 'Date:\s*(\d{2}\.\d{2}\.\d{4})'
  total: 'Total:\s*(?:[A-Z$€£]{1,3}\s*)?([\d.,]+)(?!\s*Subtotal)'
  vat: 'VAT:\s*([\d.,]+)'
  client: '(?:Bill To|Client):\s*([A-Za-z\s.,-]+?)(?:\s*№|\s*Phone:|\s*VAT Number:|\n|Invoice No:|Date:)'
  line_items: 'Description\s*Amount\s*(.*?)(?:Subtotal|Total)'
vukov_development_services:
  document_type: vukov_invoice
  keywords:
    - "Vukov Development Services"
    - "Вуков Дивелъпмънт Сървисис ЕООД"
  invoice_number: '(?:Invoice No:|Номер:|Фактура №?:|Invoice #)\s*([\d]+)'
  date: '(?:Date:|Дата:)\s*(\d{2}[./]\d{2}[./]\d{4}|\d{2}/\d{2}/\d{4}|\d{4}-\d{2}-\d{2})'
  total: '(?:Total|Сума за плащане|Обща сума)[:\s]*(?:[A-Z$€£]{1,3}\s*)?([\d.,]+)'
  vat: '(?:VAT|ДДС)[:\s]*([\d.,]+)'
  client: '(?:Получател:|Client:|Bill To:)\s*([A-Za-z\s.,-]+?)(?:\s*ДДС №|\s*Идент. №|\n|\s*Phone:|\s*VAT Number:|$)'
  line_items: '(?:Наименование на стоката/услугата|Description)\s*(?:Код|Amount)\s*(.*?)(?:Данъчна основа:|Subtotal|Total)'

etkyusi_eood:
  document_type: etkyusi_invoice
  keywords:
    - "ЕтКюСи ЕООД"
  invoice_number: 'Фактура\s*No:(\d+)'
  date: 'Дата на издаване:\s*(\d{2}\.\d{2}\.\d{4})'
  total: 'Сума за плащане:\s*([\d.,]+)'
  vat: 'Начислен ДДС(?:\(\d+%\))?:\s*([\d.,]+)'
  client: 'Получател:\s*Име на фирма:\s*([^\n]+)'
  line_items: '(?:Име на стоката/услугата)\s*(?:Мярка)\s*(.*?)(?:Данъчна основа:|Междинна сума|Сума за плащане)'
replit:
  document_type: replit_invoice
  keywords:
    - "Replit"
  invoice_number: 'Invoice\s*number\s*([A-Z0-9\s\.\-]+)'
  date: 'Date\s*of\s*issue\s*([A-Za-z]+\s+\d{1,2},\s*\d{4})'
  total: '(?:Total|Amount Due|Grand Total|Balance Due|Sum|Gesamtbetrag|Total Amount|Total Payable|Net Total|Total Incl. VAT)[:\s]*(?:[A-Z$€£]{1,3}\s*)?([\d.,]+)'
  vat: 'VAT\s*(\d+%)?:([\d.,]+)'
  client: 'Replit\n([A-Za-z\s.,-]+)'
  line_items: 'Description\s*Amount\s*(.*?)(?:Subtotal|Total)'
atqc_ltd:
  document_type: atqc_invoice
  keywords:
    - "AtQC Ltd"
  invoice_number: 'No:(\d+)'
  date: 'Date of issue:\s*(\d{2}\.\d{2}\.\d{4})'
  total: 'Due Amount:\s*([\d.,]+)\s*([A-Z]{3})'
  vat: 'VAT\(0%\):\s*([\d.,]+)'
  client: 'Recipient\nCompany Name:([A-Za-z\s.,-]+)'
  line_items: 'Description\s*Amount\s*(.*?)(?:Subtotal|Total)'
receipt:
  document_type: receipt
  keywords:
    - "receipt"
    - "cash memo"
    - "sales slip"
    - "thank you"
    - "purchase"
    - "store"
    - "transaction"
    - "фискален бон"
    - "касова бележка"
    - "payment"
    - "order"
    - "summary"
  merchant_name: '^(.*?)(?:\n|\s*\d{1,2}[./-]\d{1,2}[./-]\d{2,4}|\s*Tel|\s*Phone|\s*www\.)' # Improved to capture name before date, phone, or website
  date: '(?:Date|Datum|Dato|Fecha|Date of Issue|Trans Date|Sale Date|Order Date|Invoice Date|Дата)[:\s]*(\d{1,2}[./-]\d{1,2}[./-]\d{2,4}|\d{1,2}\s+(?:Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)[a-z]*\s+\d{2,4}|\d{4}-\d{2}-\d{2})' # Added YYYY-MM-DD format
  total: '(?:Total|Amount Due|Grand Total|Balance Due|Sum|Gesamtbetrag|Total Amount|Total Payable|Net Total|Total Incl. VAT|TOTAL|Balance|ОБЩО)[:\s]*(?:[A-Z$€£]{1,3}\s*)?([\d.,]+)' # Added "Balance"
  vat: '(?:VAT|Tax|MwSt|Sales Tax|ДДС)[:\s]*([\d.,]+)' # Added "Sales Tax"
  transaction_id: '(?:Trans|Transaction|Auth|Approval|Order)\s*ID[:#]*\s*([A-Z0-9]+)' # Added "Order ID"
  line_items: '(?P<quantity>\d+)?\s*(?P<description>.+?)\s+(?P<amount>[\d.,]+)' # More robust line item pattern with named groups


document:
  document_type: generic_document
  keywords: [] # No specific keywords, it's a fallback
  invoice_number: '(?:Invoice|Bill|Ref|No|Number|Фактура)[:\s#]*([A-Z0-9\-]+)'
  date: '(?:Date|Datum|Dato|Fecha|Date of Issue|Дата)[:\s]*(\d{1,2}[./-]\d{1,2}[./-]\d{2,4}|\d{1,2}\s+(?:Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)[a-z]*\s+\d{2,4}|\d{4}-\d{2}-\d{2})'
  total: '(?:Total|Amount Due|Grand Total|Balance Due|Sum|Gesamtbetrag|Total Amount|Total Payable|Net Total|Total Incl. VAT|TOTAL|Сума за плащане|Обща сума)[:\s]*(?:[A-Z$€£]{1,3}\s*)?([\d.,]+)'
  vat: '(?:VAT|Tax|MwSt|Sales Tax|ДДС)[:\s]*([\d.,]+)'
  client: '(?:Bill To|Customer|Client|Recipient|Получател)[:\s]*(.*?)(?:\n|$)'
  line_items: '(?P<quantity>\d+)?\s*(?P<description>.+?)\s+(?P<amount>[\d.,]+)'